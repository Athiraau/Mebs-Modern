@{
    ViewData["Title"] = "AUCTIONEERPUNCHREQUEST";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="~/css/index.css">
    <script src="~/js/site.js"></script>


    <style>

        .completionyear {
            width: 30%;
        }

        .pagecontiner {
            margin-left: auto;
            width: auto;
        }

        .form-container {
            border-radius: 8px;
            padding: 15px;
            background-color: #ffff;
            /*box-shadow: 0 2px 5px rgba(17,45,78,1);*/
        }


        .form-control {
            height: 30px;
            font-size: small;
        }

        .form-label {
            font-weight: 500;
            font-size: small;
            margin-top: 13px;
            color: #27005D;
        }

        .label1 {
            font-size: small;
            color: #27005D;
        }

        .btn {
            display: inline-block;
            padding: 6px 10px;
            font-size: 10px;
            font-weight: bold;
            text-align: center;
            text-decoration: none;
            background-color: #f0300a;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .btn-grad {
            background-image: linear-gradient(to right, #00246B 100%, #00246B 20%);
            text-transform: uppercase;
            transition: 0.5s;
            width: 100px;
            padding: 6px;
            background-size: 200% auto;
            color: white;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            display: block;
        }


        .btn:hover {
            background-color: pink;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            margin-top: 12px;
        }

            .btn-group .btn {
                margin: 0 50px;
            }



        table {
            width: 100%;
            border-collapse: collapse;
            font-size: initial;
        }

        .img1 {
            display: none;
            cursor: pointer;
        }

        th,
        td {
            border: 1px solid white;
            text-align: left;
            padding: 8px;
            font-size: initial;
        }

        th {
            background-color: #f2f2f2;
            font-size: initial;
        }

        .fs-10 {
            font-size: 10px;
        }

        .mt-5 {
            margin-left: -286px;
            width: 928px;
            margin-top: 12px;
        }
    </style>

</head>

<body>

    <div class="pagecontiner">
        <div class="form-container">

            <div class="mt-5" id="dcontainer2" style="margin-left:272px;">


                <div class="mt-5" style="width: 730px;">
                    <table class="table table-striped table-hover" id="your-table-id">
                        <thead>
                            <tr>
                                <th class="table-secondary text-center text-white" style="background-color: #00246B" colspan="8">
                                    AUCTIONEER PUNCHING REQUEST
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">AUCTIONEER ID:</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="aucid" class="form-control" />
                                        </div>
                                    </div>
                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <button class="btn-grad" id="btn">Search</button>
                                        </div>
                                    </div>
                                </th>

                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">AUCTIONEER ID</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="auctioneerid" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">NAME</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="auctioneername" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary text-center text-white" style="background-color: #00246B" colspan="8">
                                    TODAY PUNCHED DETAILS
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">BRANCH</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="branch_id" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">BRANCH NAME</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="branch_name" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">AREA</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="area" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">DISTRICT</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="district" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>

                            </tr>
                            <tr>
                                <th class="table-secondary text-center text-white" style="background-color: #00246B" colspan="8">
                                    REQUESTING BRANCH
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">BRANCH ID</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="rqbranch" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">BRANCH NAME</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="rqbranchname" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>

                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">AREA</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="rqarea" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>

                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">DISTRICT</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="rqdistrict" class="form-control" readonly="readonly" />
                                        </div>
                                    </div>
                                </th>

                            </tr>
                            <tr>
                                <th class="table-secondary text-center text-white" style="background-color: #00246B" colspan="8">
                                    REMARKS
                                </th>
                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="form-group row">
                                        <span class="col-sm-3 col-form-label form-label">ENTER REMARK</span>
                                        <div class="col-sm-9" style="margin-top:13px">
                                            <input type="text" id="remark" class="form-control" />
                                        </div>
                                    </div>
                                </th>

                            </tr>
                            <tr>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="btn-group  label1">
                                        <button class="btn-grad" id="btnsbmt" onclick="SubmitForm();">SUBMIT</button>

                                    </div>

                                </th>
                                <th class="table-secondary  text-white" colspan="4">
                                    <div class="btn-group  label1">
                                        <button class="btn-grad" onclick="ExitForm();">EXIT</button>

                                    </div>

                                </th>

                            </tr>


                        </thead>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <script>
        //----redirect to index page

        function ExitForm() {

            var root = '';
            var baselink = '@ViewData["baseurl"]';
            var id = '@ViewData["HeadName"]';

            if (document.location.hostname == 'localhost') {
                window.location.href = "/Loans/Index?datas=" + id;
            }
            else {
                root = '@ViewData["root"]';
                domainurl = baselink + root;
                window.location.href = domainurl + "/Loans/Index?datas=" + id;
            }

        }
    </script>


    <script>
        // API GET LOAD
        window.onload = function OnloadFunction() {
            ActiveLoginCheck();
            EmpAccess();
            alertfunction();

        }
        function ActiveLoginCheck() {
            var user = '@ViewData["EmpCode"]';
            if (user == null || user == '') {
                alert('INACTIVE SESSION');
                loadIndex();
            }

        }
        var slno = '0';
        function EmpAccess() {

            var _link = '';
            if (document.location.hostname == 'localhost') { _link = "/Loans/getAPIData"; }
            else { var root = '@ViewData["root"]'; _link = "/" + root + "/Loans/getAPIData"; }


            const EmpCode = '@ViewData["EmpCode"]';
            indata = "Mebs_Auction" + "^" + "Auc_reqAccess" + "~" + EmpCode + "*" + 1;
            var response = '';
            $.ajax({
                type: "GET",
                url: _link,
                data: { datas: indata },
                async: false,
                success: function (response) {

                    slno = response;

                },
                error: function (response) {
                    // alert("failed");
                }
            });


            slno = JSON.parse(slno);
            slno = slno[0].RESULT;


        }
        function alertfunction() {


            if (slno == 0) {
                alert("You Are Not Authorised to View This Page !!");
                loadindex();
                return;
            }




        }
        function resetForm() {
            var root = '';
            var baselink = '@ViewData["baseurl"]';
            var id = '@ViewData["HeadName"]';

            if (document.location.hostname == 'localhost') {
                window.location.href = "/loans/auctioneerpunchrequest?datas=" + id;
            }
            else {
                root = '@ViewData["root"]';
                domainurl = baselink + root;
                window.location.href = domainurl + "/loans/auctioneerpunchrequest?datas=" + id;
            }


        }
        btn.onclick = function () {
            callAPIResponse3();
        }
        //alert
        function callAPIResponse3() {
            var _link = '';
            if (document.location.hostname == 'localhost') { _link = "/Loans/getAPIData"; }
            else { var root = '@ViewData["root"]'; _link = "/" + root + "/Loans/getAPIData"; }

            var aucid = document.getElementById("aucid").value;

            indata = "Mebs_Auction" + "^" + "auc_alert" + "~" + aucid;

            var response = '';
            $.ajax({
                type: "GET",
                url: _link,
                data: { datas: indata },
                async: false,
                success: function (response) {
                    reqs = response;



                }

            });


            reqs = JSON.parse(reqs);
            reqs = reqs[0].RESULT;




            if (reqs > 0) {
                Punched_Branch();
                Request_Branch();

            }
            else {
                alert('Check the Auctioneer Id and Re-enter  !!!!');
                resetForm();
            }
        }
        //fetch data
        function Punched_Branch() {

            var _link = '';
            if (document.location.hostname == 'localhost') { _link = "/Loans/getAPIData"; }
            else { var root = '@ViewData["root"]'; _link = "/" + root + "/Loans/getAPIData"; }



            var Auctioneer_id = document.getElementById("aucid").value;

            indata = "Mebs_Auction" + "^" + "auc_punchdtl" + "~" + Auctioneer_id;
            var response = '';
            $.ajax({
                type: "GET",
                url: _link,
                data: { datas: indata },
                async: false,
                success: function (response) {

                    const data3 = JSON.parse(response);

                    loadDataAuc(data3);



                },
                error: function (response) {
                    // alert("failed");
                }
            });
        }


        function loadDataAuc(data) {




            data.forEach(item => {


                document.getElementById('auctioneerid').value = item.AUCTIONEER_ID;
                document.getElementById('auctioneername').value = item.AUCTIONEER_NAME;
                document.getElementById('branch_id').value = item.BRANCH_ID;
                document.getElementById('branch_name').value = item.BRANCH_NAME;
                document.getElementById('area').value = item.AREA;
                document.getElementById('district').value = item.DISTRICT;


                // alert(item.AUCTIONEER_NAME);

            });


        }
        //fetch data
        function Request_Branch() {

            var _link = '';
            if (document.location.hostname == 'localhost') { _link = "/Loans/getAPIData"; }
            else { var root = '@ViewData["root"]'; _link = "/" + root + "/Loans/getAPIData"; }



            const Br_Id = '@ViewData["BrID"]';

            indata = "Mebs_Auction" + "^" + "auc_reqdtl" + "~" + Br_Id;
            var response = '';
            $.ajax({
                type: "GET",
                url: _link,
                data: { datas: indata },
                async: false,
                success: function (response) {

                    const data3 = JSON.parse(response);

                    loadDataAuc1(data3);



                },
                error: function (response) {
                    // alert("failed");
                }
            });
        }


        function loadDataAuc1(data) {




            data.forEach(item => {



                document.getElementById('rqbranch').value = item.BRANCH_ID;
                document.getElementById('rqbranchname').value = item.BRANCH_NAME;
                document.getElementById('rqarea').value = item.AREA;
                document.getElementById('rqdistrict').value = item.DISTRICT;


                // alert(item.AUCTIONEER_NAME);

            });


        }
        function validatefunction() {


            var aucid1 = document.getElementById("aucid").value;
            var remark1 = document.getElementById("remark").value;



            // Validate auctioneerId Selection
            if (aucid1 === "") {
                alert("Please Enter a AuctioneerId.");
                document.getElementById("btnsbmt").disabled = false;
                return 0;
            }



            // Validate Completion Year
            if (remark1 === "") {
                alert("Please Enter Remark.");
                document.getElementById("btnsbmt").disabled = false;
                return 0;
            }

            // All validations passed
            return 1;
        }
        //submit
        var check = '1';
        var slno = '0';
        function SubmitForm() {
            document.getElementById("btnsbmt").disabled = true;
            var a = validatefunction();



            if (!a == 1)
                return;

            const EmpCode = '@ViewData["EmpCode"]';
            var Auctioneer_id = document.getElementById("auctioneerid").value;
            var br_id = document.getElementById("branch_id").value;
            var br_name = document.getElementById("branch_name").value;
            var area = document.getElementById("area").value;
            var district = document.getElementById("district").value;
            var rqbr_id = document.getElementById("rqbranch").value;
            var rqbr_name = document.getElementById("rqbranchname").value;
            var rqarea = document.getElementById("rqarea").value;
            var rqdistrict = document.getElementById("rqdistrict").value;



            var remark = document.getElementById("remark").value;


            var indata = Auctioneer_id + "*" + br_id + "*" + br_name + "*" + area + "*" + district + "*" + rqbr_id + "*" + rqbr_name + "*" + rqarea + "*" + rqdistrict + "*" + EmpCode + "*" + remark;
            PostDataAPICall(indata);
            // alertfunction();


            //   resetForm();
            //   }
        }
        function PostDataAPICall(indata) {

            var _link = '';
            if (document.location.hostname == 'localhost') { _link = "/Loans/postAPIData"; }
            else { var root = '@ViewData["root"]'; _link = "/" + root + "/Loans/postAPIData"; }


            indata = "Auctioneer_PunchCntrl" + "^" + "submitform_Req" + "~" + indata;

            const a = "";
            $.ajax({
                type: "POST",
                url: _link,
                data: { datas: indata },
                async: false,
                success: function (response) {

                    //alert(response);
                    slno = response;

                },
                error: function (response) {
                    check = 0;
                    //   alert("failed");
                }
            });

            slno = JSON.parse(slno);
            slno = slno[0].RESULT;

            alert(slno);
            resetForm();


        }
    </script>
</body>
</html>